{"mappings":"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","sources":["public/js/index.js","public/js/mapbox.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\nimport '@babel/polyfill';\r\nimport { displayMap } from './mapbox';\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\n// DOM ELEMENTS\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book_tour');\r\n\r\n// DELEGATION\r\nif (mapBox) {\r\n  const locations = JSON.parse(mapBox.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm)\r\n  loginForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\r\n\r\nif (userDataForm)\r\n  userDataForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n    const file = document.getElementById('photo').files[0];\r\n    // console.log(file);\r\n    form.append('name', name);\r\n    form.append('email', email);\r\n    form.append('photo', file);\r\n\r\n    // console.log(form);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n\r\nif (userPasswordForm)\r\n  userPasswordForm.addEventListener('submit', async e => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password'\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n\r\nif (bookBtn)\r\n  bookBtn.addEventListener('click', e => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourid } = e.target.dataset;\r\n    bookTour(tourid);\r\n  });\r\n","/* eslint-disable */\r\nexport const displayMap = locations => {\r\n  mapboxgl.accessToken =\r\n    'pk.eyJ1IjoicmFhYWpyYXRob2QiLCJhIjoiY2s4bzNvbzlwMDFjazNmcWlybmdkYjJwZyJ9.fysGR74dD0VOhchhgkzuMA';\r\n\r\n  var map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/raaajrathod/ck8o3xmy6131a1ip7qpa6294z',\r\n    scrollZoom: false,\r\n    center: [-118.113491, 34.111745],\r\n    zoom: 10,\r\n    interactive: false\r\n  });\r\n\r\n  const bounds = new mapboxgl.LngLatBounds();\r\n\r\n  locations.forEach(loc => {\r\n    // Create marker\r\n    const el = document.createElement('div');\r\n    el.className = 'marker';\r\n\r\n    // Add marker\r\n    new mapboxgl.Marker({\r\n      element: el,\r\n      anchor: 'bottom'\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .addTo(map);\r\n\r\n    // Add popup\r\n    new mapboxgl.Popup({\r\n      offset: 30\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n      .addTo(map);\r\n\r\n    // Extend map bounds to include current location\r\n    bounds.extend(loc.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 150,\r\n      left: 100,\r\n      right: 100\r\n    }\r\n  });\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password\r\n      }\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout'\r\n    });\r\n    if ((res.data.status = 'success')) location.reload(true);\r\n  } catch (err) {\r\n    // console.log(err.response);\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","/* eslint-disable */\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","/* eslint-disable node/no-unsupported-features/es-syntax */\r\n// eslint-disable-next-line node/no-unsupported-features/es-syntax\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n// eslint-disable-next-line no-undef\r\nconst stripe = Stripe('pk_test_qXa7Dus2doqT9pRCuREJg5wS00Z41XNA6y');\r\n// let elements = stripe.elements();\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const bookTour = async tourId => {\r\n  //  Get Cheekout session for\r\n  try {\r\n    const session = await axios(`/api/v1/booking/checkout-session/${tourId}`);\r\n    // console.log(session);\r\n\r\n    // 2) Create checkout form + chanre credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id\r\n    });\r\n  } catch (err) {\r\n    // console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"app.js.map","sourceRoot":"/"}